import os
import time
import datetime
import pytz
import requests
import random

BOT_TOKEN = os.getenv("BOT_TOKEN")
CHAT_IDS = ["882777450", "228193993"]

messages_schedule = {
    "07:00": [
        "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ, –ª—é–±–∏–º–∞—è. –°–¥–µ–ª–∞–π –∑–∞—Ä—è–¥–∫—É —Å–µ–±–µ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω—É) –õ—é —Ç—èüòò",
        "–°–æ–ª–Ω—ã—à–∫–æ, –¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ! –ó–∞–±–æ—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –º–µ–ª–æ—á–µ–π ‚Äî –∑–∞—Ä—è–¥–æ—á–∫–∞ –∂–¥—ë—Ç —Ç–µ–±—è. –ò —è —Å–µ–π—á–∞—Å –Ω–µ –ø—Ä–æ —Ç–µ–ª–µ—Ñ–æ–Ωüòâ",
        "–õ—é–±–∏–º–∞—è, –ø—Ä–æ—Å—ã–ø–∞–π—Å—è. –Ø –¥—É–º–∞—é –æ —Ç–µ–±–µ‚Ä¶ –∏ —Ç–≤–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω —Ç–æ–∂–µ —Ö–æ—á–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è!"
    ],
    "07:30": [
        "7:30 ‚Äî —Ç—ã –ø–æ–¥–∫–ª—é—á–∏–ª–∞ –∑–∞—Ä—è–¥–∫—É?",
        "–ü–æ—Ä–∞–¥—É–π –º–µ–Ω—è ‚Äî –ø–æ—Å—Ç–∞–≤—å –Ω–∞ –∑–∞—Ä—è–¥–∫—É!",
        "–Ø –µ—â—ë –Ω–∞–¥–µ—é—Å—å, —á—Ç–æ —Ç–µ–ª–µ—Ñ–æ–Ω —É–∂–µ –Ω–∞ –∑–∞—Ä—è–¥–∫–µ."
    ],
    "08:00": [
        "8:00 ‚Äî –≤—Å—ë –µ—â—ë –±–µ–∑ –∑–∞—Ä—è–¥–∫–∏?",
        "–õ—é–±–∏–º–∞—è, –∑–∞—Ä—è–¥–∫–∞ –Ω–µ —à—É—Ç–∫–∞. –ü–æ–¥–∫–ª—é—á–∏!",
        "–¢—ã –∂–µ –∑–Ω–∞–µ—à—å, —è –ø–µ—Ä–µ–∂–∏–≤–∞—é."
    ],
    "08:30": [
        "8:30 ‚Äî —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–∞ –Ω—É–ª–µ? –Ø –≤ –ø–∞–Ω–∏–∫–µ!",
        "–ü–æ–¥–∫–ª—é—á–∏ –∑–∞—Ä—è–¥–∫—É, —Å–æ–ª–Ω—ã—à–∫–æ!",
        "–ë–µ–∑ –∑–∞—Ä—è–¥–∫–∏ ‚Äî –Ω–∏–∫—É–¥–∞!"
    ],
    "09:00": [
        "9:00 ‚Äî –Ω–∞—á–∞–ª–æ –¥–Ω—è —Å –ª—é–±–≤–∏ –∏... —Å –∑–∞—Ä—è–¥–∫–∏!",
        "–¢—ã –ª—É—á—à–µ –≤—Å–µ—Ö. –î–∞–∂–µ –∫–æ–≥–¥–∞ –∑–∞–±—ã–≤–∞–µ—à—å –∑–∞—Ä—è–¥–∏—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω.",
        "–ü–æ—Å—Ç–∞–≤—å –Ω–∞ –∑–∞—Ä—è–¥–∫—É, –ø–æ–∫–∞ –Ω–µ —É–±–µ–∂–∞–ª %!"
    ],
    "15:00": [
        "15:00 ‚Äî –¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏–≤–µ—Ç–∏–∫! –ö–∞–∫ –∑–∞—Ä—è–¥–æ—á–∫–∞?",
        "–¢–µ–ª–µ—Ñ–æ–Ω –≤—Å—ë –µ—â—ë –Ω–µ –ø–æ–¥–∫–ª—é—á—ë–Ω? –î–∞–≤–∞–π –∏—Å–ø—Ä–∞–≤–∏–º —ç—Ç–æ.",
        "–ú–æ—è –∑–∞–±–æ—Ç–∞ ‚Äî —ç—Ç–æ —Ç—ã. –ò –∑–∞—Ä—è–¥–∫–∞ —Ç–æ–∂–µ."
    ],
    "20:00": [
        "–ó–¥–æ—Ä–æ–≤–∞, –∑–∞–µ–±–∞–ª. –ß—ë —Ç–∞–º –ø–æ –∑–∞—Ä—è–¥–∫–µ, –º–∞—Ç—å?",
        "–¢–≤–æ–π —Ç–µ–ª–µ—Ñ–æ–Ω —É–∂–µ –ø–∏—à–µ—Ç –∑–∞–≤–µ—â–∞–Ω–∏–µ... –ü–æ–¥—É–º–∞–π –∫–∞–∫ –±—É–¥–µ—à—å –º–µ–º—á–∏–∫–∏ —Å–º–æ—Ç—Ä–µ—Ç—å?",
        "–û, –ø—Ä–∏–≤–µ—Ç! –í—Å–ø–æ–º–Ω–∏, –∫–∞–∫ –≤—á–µ—Ä–∞ –∏—Å–∫–∞–ª–∞ –∑–∞—Ä—è–¥–∫—É –ø–æ –≤—Å–µ–π –∫–≤–∞—Ä—Ç–∏—Ä–µ... –ü–æ–≤—Ç–æ—Ä–∏–º?üòÅ"
    ],
    "21:00": [
        "21:00 ‚Äî –≤–µ—á–µ—Ä–Ω—è—è –∑–∞–±–æ—Ç–∞: –Ω–µ –∑–∞–±—É–¥—å –∑–∞—Ä—è–¥–∫—É!",
        "–ó–∞—Ä—è–¥–∏ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω, –∏ —Å–≤–æ–∏ –æ–±–∞—è—à–∫–∏!",
        "–¢—ã –∂–µ –∑–Ω–∞–µ—à—å, –±–µ–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –º–Ω–µ –Ω–µ –∂–∏—Ç—å!"
    ],
    "22:00": [
        "22:00 ‚Äî –µ—â—ë –Ω–µ –Ω–∞ –∑–∞—Ä—è–¥–∫–µ?",
        "–ü–æ—Å–ª–µ–¥–Ω–∏–π —à–∞–Ω—Å! –ü–æ—Å—Ç–∞–≤—å —Ç–µ–ª–µ—Ñ–æ–Ω –Ω–∞ –∑–∞—Ä—è–¥–∫—É.",
        "–°–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ –≤ –¥–æ–º–µ ‚Äî —ç—Ç–æ –∑–∞—Ä—è–¥–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞."
    ],
    "23:00": [
        "–ü–æ—Å–ª–µ–¥–Ω–µ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ. –õ–æ–∂—É—Å—å —Å–ø–∞—Ç—å.",
        "–¢—ã —Ç–æ—á–Ω–æ —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã –æ–Ω —É–º–µ—Ä –Ω–æ—á—å—é?",
        "–Ø –Ω–µ —à—É—á—É. –ü–æ–¥–∫–ª—é—á–∞–π –∑–∞—Ä—è–¥–∫—É.",
        "–ú—ã –≤ –æ—Ç–≤–µ—Ç–µ –∑–∞ —Ç–µ—Ö, –∫–æ–≥–æ –Ω–µ –∑–∞—Ä—è–∂–∞–µ–º."
    ],
    "00:00": [
        "–î–∞–∂–µ —è —Å–ø–ª—é, –Ω–æ –±–æ—Ç —Å–ª–µ–¥–∏—Ç.",
        "–ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–≤–æ–Ω–æ–∫. –ò–ª–∏ –ø–æ—Ç–æ–º –±—É–¥–µ—Ç –ø–æ–∑–¥–Ω–æ.",
        "–ï—Å–ª–∏ –Ω–µ –Ω–∞ –∑–∞—Ä—è–¥–∫–µ ‚Äî —è –ø–ª–∞–∫–∞—Ç—å."
    ]
}

sent_today = set()

def send_message(text):
    for chat_id in CHAT_IDS:
        chat_id = chat_id.strip()
        if chat_id:
            url = f"https://api.telegram.org/bot{BOT_TOKEN}/sendMessage"
            payload = {"chat_id": chat_id, "text": text}
            try:
                response = requests.post(url, data=payload)
                print(f"{datetime.datetime.now()}: '{text}' ‚Üí {chat_id} ({response.status_code})")
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: {e}")

def get_germany_time():
    tz = pytz.timezone("Europe/Berlin")
    return datetime.datetime.now(tz)

if __name__ == "__main__":
    send_message("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏.")
    while True:
        now = get_germany_time()
        current_time = now.strftime("%H:%M")

        if current_time in messages_schedule and current_time not in sent_today:
            message = random.choice(messages_schedule[current_time])
            send_message(message)
            sent_today.add(current_time)

        if current_time == "01:00":
            sent_today.clear()

        time.sleep(30)